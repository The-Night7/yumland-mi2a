<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Espace Livreur</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        body { background-color: #FDFBF7; font-family: 'Lato', sans-serif; margin: 0; padding: 0; }
        .app-header { background-color: #2D2D2D; color: #FDFBF7; padding: 20px; text-align: center; }
        .order-list { padding: 20px; }
        .delivery-card { background-color: white; border: 2px solid #D32F2F; border-radius: 8px; padding: 15px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn-livreur { font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; min-height: 60px; border-radius: 8px; text-decoration: none; width: 100%; border: none; font-size: 1.1rem; }
        
        /* Nav du bas */
        .nav-bottom { position: fixed; bottom: 0; width: 100%; background: #2D2D2D; display: flex; justify-content: space-around; padding: 15px 0; }
        .nav-item { color: white; text-decoration: none; font-weight: bold; }
        .nav-item.active { color: #FFC107; }

        /* Le fameux mode nuit ! */
        body.dark-mode { background-color: #000000 !important; color: white !important; }
        body.dark-mode .delivery-card { background-color: #1a1a1a !important; border-color: #FFC107 !important; color: white !important; }
        body.dark-mode .app-header { border-bottom: 2px solid #FFC107; }
    </style>
</head>
<body>
<div class="delivery-app">
    <header class="app-header">
        <h2 style="margin:0; font-family: 'Oswald', sans-serif;">LIVRAISON</h2>
        <small style="display:block; margin-bottom: 15px;">Zone : Cergy Centre</small>
        
        <button id="toggle-dark-mode" class="btn-livreur" style="background-color: #FFC107; color: #000;">
            üåô MODE NUIT
        </button>
    </header>

    <main class="order-list" id="deliveries-container">
        </main>

    <div style="height: 80px;"></div> <nav class="nav-bottom">
        <a href="#" class="nav-item active">Commandes</a>
        <a href="profil.html" class="nav-item">Mon Profil</a>
        <a href="../../index.html" class="nav-item" style="color: #D32F2F;">Quitter</a>
    </nav>
</div>

<script>
    // 1. Base de donn√©es des livraisons en cours
    const deliveries = [
        {
            id: 'CMD-002',
            client: 'M. Martin',
            address: '12 Rue du Port, Cergy',
            code: 'A123',
            floor: '3√®me √©tage',
            tel: '06 01 02 03 04',
            comment: 'Sonner fort',
            total: '22.50‚Ç¨'
        },
        {
            id: 'CMD-005',
            client: 'Mme. Durand',
            address: "5 Bd de l'Oise, Cergy",
            code: 'Interphone B',
            floor: '1er √©tage',
            tel: '06 05 06 07 08',
            comment: '',
            total: '15.00‚Ç¨'
        }
    ];

    // 2. Fonction pour afficher les cartes
    function renderDeliveries() {
        const container = document.getElementById('deliveries-container');
        
        if(deliveries.length === 0) {
            container.innerHTML = '<p style="text-align:center; padding:20px; font-weight:bold;">Aucune commande √† livrer pour le moment.</p>';
            return;
        }

        // On cr√©e le code HTML pour chaque commande
        container.innerHTML = deliveries.map(d => `
            <div class="delivery-card">
                <div style="display: flex; justify-content: space-between; align-items: baseline;">
                    <h3 style="margin-top:0;">${d.client}</h3>
                    <span style="font-weight:bold; color:var(--color-primary);">${d.total}</span>
                </div>
                
                <p style="font-size: 1.1rem; margin: 5px 0;">üìç <strong>Adresse:</strong> ${d.address}</p>
                <p style="font-size: 1rem; margin: 5px 0;">üîë <strong>Acc√®s:</strong> ${d.code} | ${d.floor}</p>
                <p style="font-size: 0.9rem; margin: 5px 0; color: #666;">üìû ${d.tel} ${d.comment ? `| ‚ö†Ô∏è ${d.comment}` : ''}</p>
                
                <div style="margin-top: 15px;">
                    <a href="https://www.google.com/maps/search/?api=1&query=$${encodeURIComponent(d.address)}" 
                       target="_blank" class="btn-livreur" 
                       style="background-color: #4285F4; color: white; margin-bottom: 10px;">
                       üó∫Ô∏è OUVRIR LE GPS
                    </a>

                    <button class="btn-livreur" onclick="confirmDelivery('${d.id}')" 
                            style="background-color: #D32F2F; color: white;">
                       ‚úÖ VALIDER LA LIVRAISON
                    </button>
                </div>
            </div>
        `).join('');    
    }

    // 3. Fonction pour valider et supprimer la commande
    function confirmDelivery(id) {
        if(confirm('Confirmez-vous la remise de la commande ' + id + ' au client ?')) {
            const index = deliveries.findIndex(d => d.id === id);
            if(index > -1) {
                deliveries.splice(index, 1); // Retire la commande de la liste
                renderDeliveries(); // Met √† jour l'affichage
                alert('Commande valid√©e ! Bon travail.');
            }
        }
    }

    // 4. Initialisation (Quand la page est pr√™te)
    document.addEventListener('DOMContentLoaded', () => {
        
        // On affiche les commandes
        renderDeliveries();

        // On active le Mode Nuit
        const toggleBtn = document.getElementById('toggle-dark-mode');
        if(toggleBtn) {
            toggleBtn.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                
                if(document.body.classList.contains('dark-mode')) {
                    toggleBtn.innerHTML = "‚òÄÔ∏è D√âSACTIVER MODE NUIT";
                    toggleBtn.style.backgroundColor = "white";
                } else {
                    toggleBtn.innerHTML = "üåô MODE NUIT";
                    toggleBtn.style.backgroundColor = "#FFC107";
                }
            });
        }
    });
</script>
</body>
</html>